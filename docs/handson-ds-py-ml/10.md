# 十、测试与实验设计

在本章中，我们将介绍 A/B 测试的概念。 我们将通过 t 检验、t 统计量和 p 值，这些都是用于确定结果实际上是真实的还是随机变化的结果的有用工具。 我们将深入研究一些真实的示例，熟悉一些 Python 代码，并计算 t 统计量和 p 值。

之后，我们将研究在得出结论之前，您应该进行多长时间的实验。 最后，我们将讨论可能损害您的实验结果并可能导致您得出错误结论的潜在问题。

我们将介绍以下主题：

*   A/B 测试概念
*   T 检验与 p 值
*   使用 Python 测量 t 统计量和 p 值
*   确定实验的运行时间
*   A/B 测试问题

# A/B 测试概念

如果你是一名网络公司的数据科学家，你可能会被要求花一些时间分析 A/B 测试的结果。 这些基本上是网站上的受控实验，用来衡量给定变化的影响。 那么，让我们来谈谈什么是 A/B 测试，以及它们是如何工作的。

# A/B 测试

如果你要成为一家大型科技网络公司的数据科学家，这是你肯定会参与的事情，因为人们需要在网站上进行实验，尝试不同的东西，并衡量结果，而这实际上并不像大多数人想象的那么简单。

什么是 A/B 测试？ 这是一个你通常在网站上运行的受控实验，它也可以应用到其他环境中，但通常我们谈论的是一个网站，我们将测试对该网站进行一些更改后的性能，与以前的方式相比。

你基本上有一组*控制组*的人查看旧网站，还有一组*测试*组的人看到网站的变化，其想法是衡量这两组人之间的行为差异，并使用这些数据来实际决定这种变化是否有益。

例如，我拥有一家有网站的公司，我们向人们许可软件，现在我有一个漂亮、友好的橙色按钮，当人们想要购买许可时，可以点击它，如下图左侧所示。 但是，如果我将该按钮的颜色更改为蓝色(如右侧所示)，会发生什么情况？

![](img/7ec84f37-58d0-43d6-9ffc-29e792d95830.jpg)

所以在这个例子中，如果我想知道蓝色会不会更好。 我怎么知道？

我的意思是，直觉上，这可能会更吸引人们的注意力，或者直觉上，也许人们更习惯于看到橙色的购买按钮，更有可能点击它，我可以选择这两种方式，对吗？ 所以，我自己内心的偏见或成见其实并不重要。 重要的是人们在我的实际网站上对这一变化的反应，这就是 A/B 测试所做的。

A/B 测试会将人们分为看到橙色按钮的人和看到蓝色按钮的人，然后我可以衡量这两组人之间的行为以及它们可能有什么不同，然后根据这些数据决定我的按钮应该是什么颜色。

你可以用 A/B 测试来测试各种东西。 这些措施包括：

*   **设计更改**：这些更改可以是按钮颜色、按钮位置或页面布局的更改。
*   **UI Flow**：所以，也许你实际上正在改变你的购买渠道的运作方式和人们在你网站上结账的方式，你实际上可以衡量这一点的效果。
*   **算法改变**：让我们考虑一下我们在[章](06.html)，*推荐系统*中讨论的做电影推荐的例子。 也许我想测试一种算法与另一种算法。 我真正关心的不是错误的衡量标准和我做火车测试的能力，而是开车购买或租赁或其他任何网站上的东西。
    *   A/B 测试可以让我直接衡量这个算法对我真正关心的最终结果的影响，而不仅仅是我预测其他人已经看过的电影的能力。
    *   还有任何你能想象到的东西，真的，任何影响用户与你的站点交互方式的改变都值得测试。 也许是为了让网站变得更快，也可能是任何事情。

*   **定价变化**：这一点有一点争议。 你知道，在理论上，你可以用 A/B 测试来试验不同的价位，看看它是否真的增加了交易量，以抵消价差或其他什么，但使用时要谨慎。
    *   如果顾客听到风声说其他人无缘无故地得到了比他们更好的价格，他们会对你不太满意的。 请记住，做定价实验可能会产生负面影响，你不想陷入这种情况。

# A/B 测试的计量换算

当你在网站上设计一个实验时，你需要弄清楚的第一件事是，你试图优化的是什么？ 用这个变化你真正想开的是什么？ 这并不总是很明显的事情。 也许是因为人们花费的数量，收入的数量。 好的，我们讨论了使用花费的量的差异的问题，但是如果你有足够的数据，你仍然可以，很多次达到这个指标的收敛。

然而，这可能并不是您真正想要优化的。 也许你实际上是故意亏本出售一些商品，只是为了抢占市场份额。 你的定价策略不仅仅是营收，还有更多的复杂性。

也许你真正想要衡量的是利润，这可能是一件非常棘手的事情，因为很多因素都会影响到一种特定产品可能会赚到多少钱，而这些事情可能并不总是显而易见的。 再说一次，如果你有亏损的领导者，这个实验将会打折那些应该有的效果。 也许你只关心你网站上的广告点击量，或者为了减少差异而订购数量，也许人们对此没什么意见。

The bottom line is that you have to talk to the business owners of the area that's being tested and figure out what it is they're trying to optimize for. What are they being measured on? What is their success measured on? What are their key performance indicators or whatever the NBAs want to call it? And make sure that we're measuring the thing that it matters to them.

你也可以同时测量不止一个东西，你不必挑选一个，你实际上可以报告很多不同东西的影响：

*   收入 / 收益 / 税收 / 税务局
*   利润
*   作咔嗒声 / 咔嗒着运动 / 点击 / 使发咔哒声
*   广告浏览量

如果所有这些事情都在朝着正确的方向发展，这是一个非常强烈的迹象，表明这一变化在多个方面产生了积极影响。 那么，为什么要把自己限制在一个指标上呢？ 只需确保你提前知道哪一个最重要，这将是你这个实验成功的标准。

# 如何属性转换

另一件需要注意的事情是将转换归因于下游的变化。 如果您试图驱动的操作没有在用户体验到您正在测试的东西时立即发生，那么事情就会变得有点不可靠。

假设我更改了页面 A 上按钮的颜色，然后用户转到页面 B 并执行其他操作，最终从页面 C 购买了一些东西。

那么，这次购买的功劳是谁呢？ 是 A 页，还是 B 页，还是介于两者之间的什么东西？ 我是否要根据此人点击多少次才能进入转换操作来打折该转换的积分？ 在看到该更改后，我是否只是放弃没有立即发生的任何转换操作？ 这些都是复杂的事情，很容易产生误导性的结果，因为你伪造了你如何解释转换和你测量的变化之间的这些不同的距离。

# 差异是你的敌人

您需要真正内化的另一件事是，当您运行 A/B 测试时，差异是您的敌人。

不知道自己在用数据科学做什么的人经常犯的一个错误是，他们会在网页上做一个测试，蓝色按钮和橙色按钮，不管是什么，运行一周，然后从每一组人那里拿出平均花费。 然后他们说：“哦，看！蓝色按钮的人平均比橙色按钮的人多花一美元；蓝色太棒了，我喜欢蓝色，我现在要把蓝色涂满整个网站！”

但事实上，他们可能看到的只是购买的随机变化。 他们没有足够大的样本，因为人们往往不会购买太多。 你得到了很多浏览量，但相比之下，你在网站上的购买量可能不是很多，而且这些购买量可能有很大的差异，因为不同的产品价格不同。

因此，如果你不了解差异对这些结果的影响，你很容易做出错误的决定，最终导致你的公司付出代价，而不是赚到你的公司的钱。 我们将在本章后面讨论一些衡量和核算这一问题的主要方法。

You need to make sure that your business owners understand that this is an important effect that you need to quantify and understand before making business decisions following an A/B test or any experiment that you run on the web.

现在，有时您需要选择方差较小的转换度量。 这可能是因为你网站上的数字仅仅意味着你将不得不进行多年的实验，才能根据收入或花费等方面取得显著的结果。

有时，如果您查看的多个指标(例如订单金额或订单数量)的方差较小，则可能会在看到收入信号之前看到订单数量信号。 归根结底，这是一个判断的决定。 如果你看到订单量有了很大的增长，收入可能也有不是很大的增长，那么你就不得不说，“嗯，我认为这里面可能有一些真实而有益的事情在发生。”

然而，统计数据和数据大小可以告诉您的唯一一件事是，效应是真实存在的概率。 归根结底，这是不是真的，由你来决定。 那么，让我们更详细地讨论一下如何做到这一点。

这里的关键是，仅仅看一下不同的收入是不够的。 当你试图评估一个实验的结果时，你需要把方差也考虑进去。

# T 检验与 p 值

你怎么知道 A/B 测试产生的变化实际上是你所做改变的真实结果，还是仅仅是随机变化呢？ 有几个统计工具可供我们使用，称为 t 检验或 t 统计量，以及 p 值。 让我们更多地了解这些是什么，以及它们如何帮助您确定实验是否好。

这样做的目的是要弄清楚一个结果是真实的还是不真实的。 这仅仅是数据本身固有的随机变化的结果，还是我们在控制组和测试组之间看到了实际的、统计上显著的行为变化？ T 检验和 p 值是计算这一点的一种方法。

Remember, *statistically significant* doesn't really have a specific meaning. At the end of the day it has to be a judgment call. You have to pick a probability value that you're going to accept of a result being real or not. But there's always going to be a chance that it's still a result of random variation, and you have to make sure your stakeholders understand that.

# T 统计量或 t 检验

让我们从**t-统计量**开始，也称为 t-检验。 它基本上是以标准误差为单位来衡量这两组人之间、控制组和治疗组之间的行为差异。 它是基于标准误差的，它解释了数据本身固有的差异，所以通过用标准误差对一切进行归一化，我们得到了考虑到这种差异的这两组人之间行为变化的一些衡量标准。

解释 t 统计量的方法是，高 t 值意味着这两个集合之间可能存在真正的差异，而低 t 值意味着没有太大差异。 你必须决定你愿意接受的门槛是多少？ T 统计量的符号会告诉你这是一个积极的变化还是消极的变化。

如果你把你的对照组和你的治疗组进行比较，结果 t 统计量为负，那就意味着这是一个糟糕的改变。 您最终希望 t 统计量的绝对值很大。 T 统计量的值有多大被认为是大的？ 嗯，这是有争议的。 我们将很快查看一些示例。

现在，这确实假设你的行为是正态分布的，当我们谈论人们在网站上花费的金额时，这通常是一个不错的假设。 人们花了多少钱，确实倾向于呈正态分布。

但是，对于其他特定情况，您可能需要查看 t-统计量的更精细版本。 例如，当你谈论点击率时，有一种叫做**Fisher‘s Exact Test**的测试；当你谈论每个用户的交易时，有一种叫做**E-test**的测试，比如他们看到多少网页；以及**卡方**测试，这通常与你在查看订单量时相关。 有时，您可能希望查看给定实验的所有这些统计数据，然后选择最适合您要做的事情的数据。

# P 值

现在，讨论 p 值要比讨论 t 统计量容易得多，因为你不必考虑，我们讨论的是多少标准差？ 实际值是什么意思？ P 值对人们来说更容易理解，这使它成为您向业务中的利益相关者传达实验结果的更好工具。

P 值基本上是这个实验满足零假设的概率，也就是说，在对照和处理的行为之间没有真正区别的概率。 低 p 值意味着它没有效果的可能性很低，有点像是在进行双重否定，所以这有点违反直觉，但归根结底，你只需要明白，低 p 值意味着你的改变很有可能产生了真正的影响。

您希望看到的是高 t 统计量和低 p 值，这将意味着显著的结果。 现在，在你开始你的实验之前，你需要决定你的成功门槛是多少，这意味着要和负责业务的人一起决定门槛。

那么，你愿意接受什么样的 p 值作为衡量成功的标准呢？ 是 1%吗？ 是 5%吗？ 再说一次，这基本上是没有实际影响的可能性，它只是随机方差的结果。 这只是一天结束时的判断。 很多时候，人们使用 1%，有时如果他们觉得风险稍高一些，他们会使用 5%，但总有可能你的结果只是虚假的、随机的数据。

然而，你可以选择你愿意接受的概率，认为这是一个真正的效果，值得投入生产。

当你的实验结束后，我们会讨论你宣布实验结束的时候，你想要测量你的 p 值。 如果它小于您决定的阈值，那么您可以拒绝零假设，并且您可以说“嗯，这个变化很有可能产生真正的正面或负面结果。”

如果这是一个积极的结果，那么你可以将这种改变推广到整个网站，这不再是一个实验，它是你网站的一部分，随着时间的推移，它有望让你赚到越来越多的钱，如果它是一个负面的结果，你想在它花费你更多的钱之前摆脱它。

Remember, there is a real cost to running an A/B test when your experiment has a negative result. So, you don't want to run it for too long because there's a chance you could be losing money.

这就是为什么你想每天监控实验的结果，所以如果有早期迹象表明这一变化对网站造成了可怕的影响，也许其中有漏洞或什么可怕的东西，你可以在必要时过早地关闭它，以限制损害。

让我们来看一个实际的例子，看看如何使用 Python 测量 t 统计量和 p 值。

# 使用 Python 测量 t 统计量和 p 值

让我们编造一些实验数据，用 t 统计量和 p 值来判断给定的实验结果是不是真实的效果。 我们将编造一些虚假的实验数据，并对它们运行 t 统计和 p 值，看看它是如何工作的，以及如何在 Python 中计算它。

# 对部分实验数据进行 A/B 测试

假设我们在一个网站上运行 A/B 测试，我们将用户随机分配到两组，组`A`和组`B`。 `A`组将是我们的测试对象，我们的治疗组，`B`组将是我们的对照，基本上就是网站过去的样子。 我们将使用以下代码进行设置：

```py
import numpy as np 
from scipy import stats 

A = np.random.normal(25.0, 5.0, 10000) 
B = np.random.normal(26.0, 5.0, 10000) 

stats.ttest_ind(A, B) 

```

在这个代码示例中，我们的处理组(`A`)将有一个随机分布的购买行为，他们平均每笔交易花费 25 美元，标准差为 5 到 10,000 个样本，而旧网站过去平均每笔交易 26 美元，具有相同的标准偏差和样本量。 我们基本上是在看一个实验，结果是否定的。 要计算出 t 统计量和 p 值，只需使用`scipy`中的这个方便的`stats.ttest_ind`方法。 你要做的是，你把它传递给你的治疗组和对照组，然后你的 t 统计量就会出来，如下面的输出所示：

![](img/fe9d3310-3841-482e-b97a-098ff9084522.jpg)

在本例中，我们的 t 统计量为-14。 负数表示这是一种负数变化，这是一件坏事。 P 值非常非常小。 因此，这意味着，这种变化只是随机机会的结果的可能性极低。

Remember that in order to declare significance, we need to see a high t-value t-statistic, and a low p-value.

这就是我们在这里看到的，我们看到的是-14，这是一个非常高的 t 统计量绝对值，负值表示这是一件坏事，而极低的 P 值，告诉我们这几乎不可能只是随机变异的结果。

如果你在现实世界中看到这些结果，你会尽快终止这个实验。

# 当两组人之间没有真正的区别时

就像理智检查一样，让我们继续进行改变，这样这两个群体之间就没有真正的区别了。 因此，我将把组`B`，也就是本例中的控制组，改为与处理组相同，其中平均值为 25，标准差不变，样本量不变，如下所示：

```py
B = np.random.normal(25.0, 5.0, 10000) 

stats.ttest_ind(A, B) 

```

如果我们继续运行这个，您可以看到我们的 t-test 现在低于 1：

![](img/81066228-b08e-4aa3-85af-015efe4ac2b3.jpg)

记住，这是用标准差表示的。 这意味着，除非我们也有一个更高的 p 值，超过 30%，否则可能不会有真正的变化。

现在，这些仍然是相对较高的数字。 你可以看到随机变化可能是一种阴险的东西。 这就是为什么你需要提前决定什么是 p 值的可接受极限。

你知道，你可以在事后看着这件事说，“30%的几率，你知道，这并不是那么糟糕，我们可以接受这一点，”但是，不是的。 我的意思是，在现实和实践中，你希望看到 p 值低于 5%，理想情况下低于 1%，而 30%的值意味着它实际上不是那么强的结果。 所以，不要在事后证明它是合理的，在你的实验中知道你的门槛是什么。

# 样本量有影响吗？

让我们在样本大小上做一些改变。 我们是在相同的条件下创建这些集合的。 让我们来看看我们是否真的通过增加样本大小来获得行为上的不同。

# 样本量增至六位数

因此，我们将从`10000`样本转到`100000`样本，如下所示：

```py
A = np.random.normal(25.0, 5.0, 100000) 
B = np.random.normal(25.0, 5.0, 100000) 

stats.ttest_ind(A, B) 

```

您可以在下面的输出中看到，实际上 p 值变小了一点，t-test 变大了一点，但这仍然不足以声明真正的差异。 它实际上是朝你意想不到的方向去的？ 挺有意思的！

![](img/f580eba5-7fdb-41e9-a9fd-303797a27454.jpg)

但这些仍然是很高的价值。 再说一次，这只是随机方差的影响，它的影响可能比你意识到的更大。 尤其是在网站上，当你谈论订单金额的时候。

# 样本量增加了七位数

让我们将样本大小实际增加到`1000000,`，如下所示：

```py
A = np.random.normal(25.0, 5.0, 1000000) 
B = np.random.normal(25.0, 5.0, 1000000) 

stats.ttest_ind(A, B) 

```

结果如下：

![](img/7b3983dd-a665-431d-adee-6de6bb8b15ee.jpg)

那是做什么的？ 现在，我们的 t 统计量又回到了 1 以下，我们的价值大约是 35%。

当我们增加样本量时，我们看到这些波动在两个方向上都有一点点。 这意味着从 10,000 个样本到 100,000 到 1,000,000 个样本不会改变最终的结果。 像这样进行实验是一个很好的方式，可以让你有一个很好的直觉，知道你可能需要进行多长时间的实验。 究竟需要多少样本才能得出有意义的结果？ 如果你提前了解了数据的分布情况，你就可以实际运行这类模型。

# A/A 测试

如果要将集合与自身进行比较，则这称为 A/A 测试，如下面的代码示例所示：

```py
stats.ttest_ind(A, A) 

```

在下面的输出中，我们可以看到`0`的 t 统计量和`1.0`的 p 值，因为实际上这些集合之间没有任何差异。

![](img/8cd38bc5-b4f5-49db-8149-bad83224a650.jpg)

现在，如果你使用真实的网站数据来运行测试，在这些数据中，你看到的是完全相同的人，而你看到的是不同的值，这表明运行你的测试的系统本身存在问题。 归根结底，就像我说的，这都是个判断。

继续玩这个游戏，看看不同的标准差对初始数据集的影响，或者均值的差异，以及不同的样本量。 我只想让你们深入研究这些不同的数据集，并实际运行它们，看看它们对 t 统计量和 p 值有什么影响。 希望这能让你对如何解读这些结果有一个更直观的感觉。

Again, the important thing to understand is that you're looking for a large t-statistic and a small p-value. P-value is probably going to be what you want to communicate to the business. And remember, lower is better for p-value, you want to see that in the single digits, ideally below 1 percent before you declare victory.

我们将在本章的剩余部分更多地讨论 A/B 测试。 SciPy 使得计算一组给定数据的 t 统计量和 p 值变得非常容易，所以你可以非常容易地比较你的对照组和治疗组之间的行为，并衡量这种影响是真实的还是仅仅是随机变化的结果的概率。 确保您将重点放在这些指标上，并且在进行这些比较时，您正在测量您所关心的转换指标。

# 确定实验应该运行多长时间

你做一个实验要多长时间？ 要多长时间才能真正见效？ 在什么时候你会放弃呢？ 让我们更详细地讨论这一点。

如果你的公司里有人开发了一项新的实验，一种他们想要测试的新变化，那么他们对看到成功有既得利益。 他们在这件事上投入了大量的工作和时间，他们希望它能取得成功。 也许你已经做了几个星期的测试，但你仍然没有在这个实验中得出重要的结果，无论是积极的还是消极的。 你知道，他们会想要几乎无限期地运行它，希望它最终会显示出积极的结果。 你愿意做这个实验多长时间取决于你自己。

我怎么知道我什么时候运行完 A/B 测试？ 我的意思是，预测你需要多长时间才能取得显著的结果并不总是很简单，但很明显，如果你取得了一个显著的结果，如果你的 p 值低于 1%或 5%，或者你选择的任何阈值，你就完了。

在这一点上，你可以拔掉实验的插头，或者更广泛地推出变化，或者因为它实际上产生了负面影响而将其移除。 你总是可以告诉人们回去再试一次，利用他们从实验中学到的东西，也许可以再试一次，做一些改变，减轻一点打击。

另一件可能发生的事情是，它根本没有收敛。 如果你没有看到 p 值随着时间的推移出现任何趋势，这可能是一个好迹象，表明你不会很快看到这种趋势收敛。 不管你运行多长时间，它都不会对行为产生足够大的影响，甚至无法衡量。

在这种情况下，你每天要做的就是在一个给定实验的图表上画出 p 值，t 统计量，无论你用什么来衡量这个实验的成功，如果你看到了一些看起来有希望的东西，你会看到 p 值开始随着时间的推移而下降。 因此，它获得的数据越多，你的结果应该得到的意义就越大。

现在，如果你看到的是一条平坦的线，或者一条到处都是的线，这有点像是告诉你，p 值哪里都不会去，不管你做这个实验多长时间，它都不会发生。 你需要事先同意，在你没有看到 p 值的任何趋势的情况下，你愿意进行这个实验的最长时间是多久？ 是两周吗？ 是一个月吗？

Another thing to keep in mind is that having more than one experiment running on the site at once can conflate your results.

花在实验上的时间是一种宝贵的商品，你在这个世界上赚不到更多的时间。 在给定的一年中，你只能进行尽可能多的实验，因为你有足够的时间去做这些实验。 所以，如果你花了太多的时间运行一个实验，而这个实验实际上没有机会收敛到一个结果上，那么你就错过了在这段时间内运行另一个可能更有价值的实验的机会，而你正在浪费在另一个实验上。

在实验链接上划清界限是很重要的，因为当你在网站上运行 A/B 测试时，时间是非常宝贵的商品，至少只要你有比你有时间更多的想法，希望是这样的。 确保你在测试一个给定的实验上花费的时间有一个商定的上限，如果你没有看到 p 值的趋势看起来很鼓舞人心，那么就是时候停下来了。

# A/B 测试问题

我想指出的重要一点是，A/B 测试的结果，即使你用 p 值以原则性的方式衡量它们，也不是福音。 有很多影响实际上会扭曲你的实验结果，并导致你做出错误的决定。 让我们来看看其中的几个，让你知道如何提防它们。 让我们来谈谈 A/B 测试的一些问题。

说 p 值是 1%听起来真的很官方，这意味着一个给定的实验只有 1%的可能性是由于虚假的结果或随机的变异，但这仍然不是衡量实验成功的全部。 有很多事情可能会歪曲或混淆你的结果，你需要意识到这一点。 所以，即使你看到一个看起来非常鼓舞人心的 p 值，你的实验可能仍然在欺骗你，你需要了解能让它发生的事情，这样你就不会做出错误的决定。

Remember, correlation does not imply causation.

即使是一个精心设计的实验，你所能说的就是这种影响有一定的可能性是由你所做的改变引起的。

归根结底，总有可能没有真正的影响，或者你甚至可能衡量了错误的影响。 这仍然可能是随机的机会，也可能会有其他事情发生，你有责任确保企业主理解这些实验结果需要得到解释，它们需要成为他们决策的一部分。

他们不能成为他们做出决定的基础，因为结果中有误差的空间，有些事情可能会歪曲这些结果。 如果这一变化有更大的商业目标，而不仅仅是推动短期收入，那么也需要考虑到这一点。

# 新奇效果

其中一个问题是新奇效应。 A/B 测试的一个主要致命弱点是运行时间较短，这会导致几个问题。 首先，改变可能会有更长期的影响，你不会去衡量这些影响，但也会对网站上的一些不同的东西产生一定的影响。

例如，也许你的客户习惯了一直看到网站上的橙色按钮，如果一个蓝色按钮出现并引起他们的注意，仅仅是因为它不同。 然而，当新客户到来之前从未见过你的网站时，他们并没有注意到这一点是不同的，随着时间的推移，即使是你的老客户也习惯了新的蓝色按钮。 很有可能的是，如果你一年后再做同样的测试，也不会有什么不同。 或者他们可能会是另一种情况。

我可以很容易地看到这样一种情况，你测试橙色按钮和蓝色按钮，在最初的两周里，蓝色按钮获胜。 人们买得更多是因为他们对它更有吸引力，因为它是不同的。 但是一年过去了，我可能会运行另一个网络实验室，把蓝色按钮和橙色按钮放在一起，橙色按钮会赢，这仅仅是因为橙色按钮是不同的，而且它是新的，仅仅因为这个原因就吸引了人们的注意。

出于这个原因，如果你确实有一些有争议的改变，最好稍后重新运行那个实验，看看你是否真的能复制它的结果。 这真的是我所知道的唯一解释新奇效应的方法；当它不再是新奇的时候，当它不再仅仅是一个可能仅仅因为它不同而吸引人们注意的变化时，实际上再测量一次。

这一点，我真的不能低估理解这一点的重要性。 这真的会扭曲很多结果，它会让你把积极的改变归因于一些不值得的事情。 与众不同本身并不是一种美德，至少在这种情况下不是。

# 季节性影响

如果你在圣诞节期间进行一项实验，人们在圣诞节期间的表现与一年中的其他时间不太一样。 他们在那个季节花的钱肯定不同了，他们在家里花了更多的时间和家人在一起，他们可能有一点，某种程度上没有工作，所以人们有不同的心态。

这甚至可能与天气有关，在夏天，人们的行为不同，因为外面很热，他们感觉有点懒，他们更频繁地度假。 也许，如果你碰巧在人口稠密的地区遭遇可怕的 Storm 时做实验，这也可能会扭曲你的结果。

再说一次，只要意识到潜在的季节性影响，假期是一个需要意识到的重大问题，如果假期是在已知具有季节性的一段时间内运行的，那么一定要对此持保留态度。

您可以通过实际查看您尝试测量的指标作为成功指标来定量确定这一点，无论您如何称呼您的转换指标，并查看其在去年同期的行为。 你每年都会看到季节性波动吗？ 如果是这样的话，你应该尽量避免在这些高峰或低谷中运行你的实验。

# 选择偏向

另一个可能会歪曲你的结果的潜在问题是选择偏见。 非常重要的一点是，客户被随机分配到你的对照组或治疗组，你的 A 组或 B 组。

然而，在某些微妙方式下，随机分配可能终究不是随机的。 例如，假设您正在散列客户 ID 以将它们放入一个或另一个存储桶中。 可能在散列函数对具有较低客户 ID 的人和较高客户 ID 的人的影响之间存在一些微妙的偏差。 这样做的效果可能是把你所有的老客户、更忠诚的客户都归入控制组，而把不太了解你的新客户归入你的治疗组。

因此，你最终衡量的只是老客户和新客户之间的行为差异。 审核您的系统以确保在实际将人员分配到对照组或治疗组时不存在选择偏差，这一点非常重要。

你还需要确保任务是粘性的。 如果你要衡量一项改变对整个会话的影响，你想要衡量他们是否在 A 页上看到了改变，但在 C 页上，他们实际上进行了转换，你必须确保他们没有在这些点击之间切换组。 因此，您需要确保在给定的会话中，人们保持在同一组中，并且如何定义会话也会变得模糊。

现在，这些都是使用已建立的现成框架，如 Google 实验或 Optimizely 或这些人中的一个可以帮助解决的问题，这样你就不会在所有这些问题上重复发明轮子。 如果你的公司确实有自己开发的内部解决方案，因为他们不喜欢与外部公司共享数据，那么是否存在选择偏见是值得审计的。

# 审计选择偏差问题

审计选择偏差问题的一种方法是运行所谓的 A/A 测试，就像我们之前看到的那样。 因此，如果你真的做了一项实验，在治疗和对照之间没有区别，你应该看不到最终结果的区别。 当你比较这两件事时，不应该有任何行为上的改变。

A/A 测试可以很好地测试您的 A/B 框架本身，并确保没有固有的偏见或其他问题，例如，会话泄漏等您需要解决的问题。

# 数据污染

另一个大问题是数据污染。 我们详细讨论了清理输入数据的重要性，这在 A/B 测试的上下文中尤其重要。 如果你有一个机器人，一个恶意的爬虫，一直在你的网站上爬行，做着大量不自然的交易，会发生什么？ 如果那个机器人最终要么被分配到治疗组，要么被分配到控制组怎么办？

那个机器人可能会歪曲你的实验结果。 非常重要的一点是，研究进入实验的输入，寻找离群值，然后分析这些离群值是什么，以及它们是否应该被排除。 你是否真的让一些机器人泄露到你的测量中，他们是否歪曲了你的实验结果？ 这是一个非常、非常常见的问题，也是你需要认识到的。

那里有恶意的机器人，有人试图侵入你的网站，有一些善意的掠夺者只是试图在你的网站上搜索搜索引擎或诸如此类的东西。 网站有各种各样的奇怪行为，你需要过滤掉这些行为，找到真正是你的客户的人，而不是这些自动化的脚本。 这实际上可能是一个非常具有挑战性的问题。 如果可以的话，使用 Google Analytics 这样的现成框架还有另一个原因。

# 归因错误

我们之前简要地谈到了归因错误。 这是如果您实际使用的是更改的下游行为，并且进入灰色区域。

您需要了解如何将这些转换率作为与您更改的事物的距离的函数来计算，并预先与业务利益相关者就如何衡量这些影响达成一致。 您还需要注意，如果您同时运行多个实验，它们是否会相互冲突？ 是否存在一个页面流，其中某人实际上可能在同一会话中遇到两个不同的实验？

如果是这样的话，这将是一个问题，你必须判断这些变化是否真的会以某种有意义的方式相互干扰，以某种有意义的方式影响客户的行为。 同样，你需要对这些结果持保留态度。 有很多事情可能会扭曲结果，你需要意识到它们。 只要意识到它们，并确保你的企业主也意识到 A/B 测试的局限性，一切都会好起来的。

此外，如果你不能在实验上投入很长的时间，你需要对这些结果持保留态度，理想的情况是稍后在不同的时间段重新测试它们。

# 简略的 / 概括的 / 简易判罪的 / 简易的

在本章中，我们讨论了什么是 A/B 测试，以及围绕它们的挑战是什么。 我们讨论了一些如何使用 t 统计量和 p 值度量实际度量方差影响的示例，并介绍了使用 Python 编码和度量 t-test。 然后，我们继续讨论 A/B 测试的短期性质及其局限性，比如新奇效应或季节性效应。

这也结束了我们在这本书中的时间。 祝贺你能走到这一步，这是一项重大的成就，你应该为自己感到自豪。 我们已经在这里介绍了很多材料，我希望您至少理解这些概念，并对当今数据科学中使用的大多数技术有一些实践经验。 这是一个非常广泛的领域，所以我们已经触及了其中的一些内容。 所以，你知道，再次祝贺你。

如果你想在这个领域发展你的事业，我真正鼓励你做的是和你的老板谈谈。 如果你在一家公司工作，该公司可以访问自己的一些有趣的数据集，看看你是否可以使用它们。 显然，在你使用公司拥有的任何数据之前，你想先和你的老板谈谈，因为围绕这些数据可能会有一些隐私限制。 你要确保你没有侵犯公司客户的隐私，这可能意味着你可能只能在工作场所的受控环境中使用或查看这些数据。 所以，当你这么做的时候要小心。

如果你能获准每周加班几天，摆弄一下这些数据集，看看你能做些什么，这不仅表明你有主动让自己成为一名更好的员工，而且你可能会发现一些对你的公司有价值的东西，这可能只会让你看起来更好，实际上可能会导致内部调动，进入一个与你想要的职业更直接相关的领域。这可能会让你看起来更好，实际上可能会导致内部调动，进入一个与你想要的职业更直接相关的领域。

所以，如果你想从我这里得到一些职业建议，我会问你一个常见的问题：“嘿，我是一名工程师，我想对数据科学有更多的了解，我该怎么做呢？” 要做到这一点，最好的方法就是去做，你知道，实际做一些附带项目，展示你可以做到，并展示一些有意义的结果。 把这一点告诉你的老板，看看它会把你引向何方。 祝好运。