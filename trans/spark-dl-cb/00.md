# 零、前言

随着深度学习在现代行业迅速成为主流，组织正在寻找将流行的大数据工具与高效的深度学习库结合起来的方法。这将有助于深度学习模型以更高的效率和速度进行训练。

在 *Apache Spark 深度学习食谱*的帮助下，您将通过特定的食谱来为深度学习算法生成结果，而不会陷入理论困境。从为深度学习建立 Apache Spark 到实现各种类型的神经网络，这本书解决了常见和不太常见的问题，以便在分布式环境中执行深度学习。除此之外，您还可以访问 Spark 中的深度学习代码，这些代码可以被重用来回答类似的问题，或者被调整来回答稍微不同的问题。您还将学习如何使用 Spark 对数据进行流式传输和聚类。一旦掌握了基础知识，您将探索如何使用热门库(如 TensorFlow 和 Keras)在 Spark 中实现和部署深度学习模型(如 CNN、RNN 和 LSTMs)。归根结底，这是一本旨在教授如何在 Spark 上实际应用模型的烹饪书，因此我们不会深入探讨本章所用模型背后的理论和数学
，尽管我们会参考在哪里可以获得每个模型的其他
信息。

到本书结束时，您将拥有在 Apache Spark 上培训和部署高效深度学习模型的专业知识。

# 这本书是给谁的

这本书是为任何对机器学习和大数据概念有基本了解，并且希望通过自上而下而不是自下而上的方法来扩展他们的理解的人准备的。这本书以即插即用的方式提供了深度学习和机器学习算法的途径。任何没有编程经验的人，尤其是使用 Python 的人，都可以按照指导一步一步地遵循食谱，轻松实现本书中的算法。这本书的大部分代码都是不言自明的。每个代码块执行一个特定的功能，或者在挖掘、操作、转换数据以及将数据拟合到深度学习模型中的操作上执行。

这本书旨在通过有趣的项目(如股票价格预测)给读者提供实际操作的体验，以及对深度学习和机器学习概念的更坚实的理解。这是可能的，因为书中每一章都提供了大量的在线资源链接，如已发表的论文、教程和指南。

# 这本书涵盖了什么

[第 1 章](01.html#OPEK0-3be7262ff9a54db3b2ea862fdce1797b)*为深度学习设置 Spark*，涵盖了在虚拟 Ubuntu 桌面环境中开始开发 Spark 所需的一切。

[第 2 章](02.html#26I9K0-3be7262ff9a54db3b2ea862fdce1797b)、*用 Spark* 创建神经网络，解释了在不使用任何深度学习库(如 TensorFlow 或 Keras)的情况下从头开始开发神经网络的过程。

[第 3 章](03.html#46EVA0-3be7262ff9a54db3b2ea862fdce1797b)、*卷积神经网络的痛点*介绍了与研究卷积神经网络进行图像识别相关的一些痛点，以及如何克服这些痛点。

[第四章](04.html#5AMKM0-3be7262ff9a54db3b2ea862fdce1797b)、*循环神经网络的痛点*，介绍了前馈神经网络和循环神经网络。我们描述了循环神经网络出现的一些痛点，以及如何利用 LSTMs 解决这些痛点。

[第 5 章](05.html#6976M0-3be7262ff9a54db3b2ea862fdce1797b)、*使用 Spark ML* 预测消防部门来电，使用 Spark 机器学习逐步开发一个用于预测旧金山市消防部门来电的分类模型。

[第 6 章](06.html#77NOM0-3be7262ff9a54db3b2ea862fdce1797b)，*在生成网络*中使用 LSTMs，给出了一种使用小说或大型文本语料库作为输入数据来定义和训练 LSTM 模型的实践方法，同时还使用训练好的模型来生成自己的输出序列。

[第 7 章](07.html#84B9I0-3be7262ff9a54db3b2ea862fdce1797b)、*使用 TF-IDF 的自然语言处理*，走完对 chatbot 对话数据进行分类以便上报的步骤。

[第八章](08.html#9BEGK0-3be7262ff9a54db3b2ea862fdce1797b)、*房地产价值预测使用 XGBoost* ，重点使用金斯县房屋销售数据集训练一个简单的线性模型，并使用它来预测房价，然后潜入稍微复杂的模型中进行同样的操作，提高预测精度。

[第九章](09.html#A39EM0-3be7262ff9a54db3b2ea862fdce1797b)、*与 LSTM* 一起预测苹果股票市场成本，重点是利用 Keras 上的 LSTM 创建深度学习模型来预测 AAPL 股票的股票市场价格。

[第 10 章](10.html#AUUF00-3be7262ff9a54db3b2ea862fdce1797b)、*使用深度卷积网络的人脸识别*，利用 10 个不同受试者的 MIT-CBCL 人脸图像数据集来训练和测试深度卷积神经网络模型。

[第 11 章](11.html#BNNTK0-3be7262ff9a54db3b2ea862fdce1797b)、*使用 Word2Vec 创建和可视化单词向量*，重点介绍了向量在机器学习中的重要性，还向用户讲解了如何利用谷歌的 Word2Vec 模型来训练不同的模型，并可视化从小说生成的单词向量。

[第 12 章](12.html#CQ2HS0-3be7262ff9a54db3b2ea862fdce1797b)、*用 Keras* 创建电影推荐引擎，重点为使用深度学习库 Keras 的用户构建电影推荐引擎。

[第 13 章](13.html#DTBMM0-3be7262ff9a54db3b2ea862fdce1797b)、*星火上有 TensorFlow 的形象分类*，重点是利用转会学习来认识世界前两名的足球运动员:c 罗和梅西。

# 充分利用这本书

1.  利用提供的所有链接来更好地理解本书中使用的一些术语。
2.  互联网是当今世界最大的大学。使用 YouTube、Udemy、edX、Lynda 和 Coursera 等网站制作关于各种深度学习和机器学习概念的视频。
3.  不要只是看了这本书就忘了它。边看书边实际执行每一步。建议您在阅读每一份食谱时打开 Jupyter 笔记本，这样您就可以在阅读本书的同时阅读每一份食谱，同时检查您为上述每个步骤获得的输出。

# 下载示例代码文件

你可以从你在[www.packtpub.com](http://www.packtpub.com)的账户下载这本书的示例代码文件。如果您在其他地方购买了这本书，您可以访问[www.packtpub.com/support](http://www.packtpub.com/support)并注册将文件直接通过电子邮件发送给您。

您可以按照以下步骤下载代码文件:

1.  登录或注册[www.packtpub.com](http://www.packtpub.com/support)。
2.  选择“支持”选项卡。
3.  点击代码下载和勘误表。
4.  在搜索框中输入图书的名称，并按照屏幕指示进行操作。

下载文件后，请确保使用最新版本的解压缩文件夹:

*   视窗系统的 WinRAR/7-Zip
*   zipeg/izp/un ARX for MAC
*   适用于 Linux 的 7-Zip/PeaZip

这本书的代码包也托管在 GitHub 上，网址为[https://GitHub . com/PacktPublishing/Apache-Spark-Deep-Learning-cook book](https://github.com/PacktPublishing/Apache-Spark-Deep-Learning-Cookbook)。如果代码有更新，它将在现有的 GitHub 存储库中更新。

我们还有来自丰富的图书和视频目录的其他代码包，可在**[【https://github.com/PacktPublishing/】](https://github.com/PacktPublishing/)**获得。看看他们！

# 使用的约定

本书通篇使用了许多文本约定。

`CodeInText`:表示文本中的码字、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟网址、用户输入和推特句柄。这里有一个例子:“保存在工作目录内的`trained`文件夹下。”

代码块设置如下:

```py
print('Total Rows')df.count()print('Rows without Null values')df.dropna().count()print('Row with Null Values')df.count()-df.dropna().count()
```

任何命令行输入或输出都编写如下:

```py
nltk.download("punkt")nltk.download("stopwords")
```

**粗体**:表示一个新的术语，一个重要的单词，或者你在屏幕上看到的单词。例如，菜单或对话框中的单词像这样出现在文本中。下面是一个例子:“在页面上单击鼠标右键，然后单击另存为...”

Warnings or important notes appear like this. Tips and tricks appear like this.

# 部分

在这本书里，你会发现几个经常出现的标题(*准备*，*怎么做...*、*它是如何工作的...*、*还有更多...*和*参见*。

要给出如何完成配方的明确说明，请使用以下章节:

# 准备好

本节告诉您配方中的预期内容，并描述如何设置配方所需的任何软件或任何初步设置。

# 怎么做...

本节包含遵循配方所需的步骤。

# 它是如何工作的...

这一部分通常包括对前一部分发生的事情的详细解释。

# 还有更多...

本节包含关于配方的附加信息，以便您更好地了解配方。

# 请参见

本节提供了该配方的其他有用信息的有用链接。

# 取得联系

我们随时欢迎读者的反馈。

**综合反馈**:发邮件`feedback@packtpub.com`并在邮件主题中提及书名。如果您对本书的任何方面有疑问，请发电子邮件至`questions@packtpub.com`。

**勘误表**:虽然我们已经尽了最大的努力来保证内容的准确性，但是错误还是会发生。如果你在这本书里发现了一个错误，如果你能向我们报告，我们将不胜感激。请访问[www.packtpub.com/submit-errata](http://www.packtpub.com/submit-errata)，选择您的图书，点击勘误表提交链接，并输入详细信息。

**盗版**:如果您在互联网上遇到任何形式的我们作品的非法拷贝，如果您能提供我们的位置地址或网站名称，我们将不胜感激。请通过`copyright@packtpub.com`联系我们，并提供材料链接。

**如果你有兴趣成为一名作者**:如果有一个你有专长的话题，你有兴趣写或者投稿一本书，请访问[authors.packtpub.com](http://authors.packtpub.com/)。

# 复习

请留下评论。一旦你阅读并使用了这本书，为什么不在你购买它的网站上留下评论呢？然后，潜在的读者可以看到并使用您不带偏见的意见来做出购买决定，我们在 Packt 可以了解您对我们产品的看法，我们的作者可以看到您对他们的书的反馈。谢谢大家！

更多关于 Packt 的信息，请访问[packtpub.com](https://www.packtpub.com/)。